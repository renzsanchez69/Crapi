<!DOCTYPE html>
<html>
<head>
	<title>WELCOME</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script src="js/o-main.js"></script>
	<link rel="stylesheet" type="text/css" href="css/o-main.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
	<link rel="stylesheet" type="text/css" href="css/c-main.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link href="css/jquery.growl.css" rel="stylesheet" type="text/css" />
	<!-- <script src="lib/jquery.min.js"></script>
	<script type="text/javascript">
		$(function(){
			if (localStorage.getItem("login_token") === null) {
			  window.location.href = 'index.html';
			}
		});
	</script> -->
</head>
<body>

<!-- Top Navigation Menu -->
<div class="topnav" id="myTopnav">
	<a href="c-main.html" class="active">Orders</a>
	<a href="c-locate-resto.html">Locate</a>
	<a href="c-hist.html">Order History</a>
	<a href="index.html" id="log-out">Logout</a>
	<a href="javascript:void(0);" class="icon" onclick="myFunction()">
	<i class="fa fa-bars"></i>
	</a>
</div>
<div class="main">
  <div class="title">
	<h1 id="resto-name">Restaurant Name*</h1>
  </div>

  <div class="left">
	<form action="">
		<input class="search" name="search" type="text" placeholder="Search.." name="search">
		<button type="button" class="btn-light search-btn-light" style="padding: 10px !important;" id="fsearch"><i class="fa fa-search"></i></button>
	</form>
  </div>
  <div class="right">
	<button class="add" id="myAdd" onclick="add_order(); return false;">ADD FOOD</button>
  </div>
  <div class="container-fluid">
	<table class="table">
		<thead>
			<tr>
				<th class="text-left"><b>Food name</b></th>
				<th class="text-center"><b>QTY</b></th>
				<th class="text-center"><b>Price</b></th>
				<th class="text-right"><b>Action</b></th>
			</tr>
		</thead>
		<tbody id="tbody-order-list">
		</tbody>
		<tfoot id="fbody-order-list">
		</tfoot>
	</table>
  </div>
  <div class="container-fluid">
	  <div class="col-md-4 col-md-offset-4 text-center">
		  <br>
		  <button class="b-order o-btn" name="order_btn" onclick="view_order(); return false;">ORDER</button>
	  </div>
  </div>
</div>
<!-- Add Modal -->
<div class="modal fade" id="ADDfood" role="dialog">
	<div class="modal-content" id="addfood">
	  <div class="modal-header">
		<span class="close" data-dismiss="modal">&times;</span>
		<h2>FOOD MENU</h2>
	  </div>
	  <div class="modal-body" id="addfood">
		<form action="">
			<input class="search" type="text" placeholder="Search.." name="afsearch">
			<button type="button" class="btn-light search-btn-light" style="padding: 10px !important;" id="afsearch"><i class="fa fa-search"></i></button>
		</form>
		<div class="table-responsive">
			<table class="table">
				<thead>
					<tr>
						<th><b>Food name</b></th>
						<th><b>Price</b></th>
					</tr>
				</thead>
				<tbody id="food-name-list">
				</tbody>
			</table>
		</div>
	  </div>
	</div>
</div>

<div class="modal fade" id="VIEWloc" role="dialog">
  <div class="modal-content" id="">
	<div class="modal-header">
	  <span class="close" data-dismiss="modal">&times;</span>
		<div class="col-12">
			<h3 class="text-center">ORDER# <b class="order_hash"></b></h3>
		</div>
	</div>
	<div class="modal-body">
		<div class="container">
			<div class="row">
				<div class="col-12">
					<h3>LOCATION</h3><hr>
				</div>
				<div class="col-5">
					<input name="latitude" type="hidden" value="10.329624">
					<input name="longitude" type="hidden" value="123.928752">
					<div class="col-12" id="map" style="height: 300px; position: relative; overflow: hidden;"></div>
				</div>
			</div>
			<br>
			<br>
			<div class="row">
				<div class="col-12">
					<h3>Order Details</h3><hr>
				</div>
				<div class="col-12">
					<div class="info">
						<p> Order #: <b class="order_hash"></b></p>
						<p> Customer name: <b id="customer_name">Anuar Delabahan</b></p>
						<p> Address: <b id="address">Cebu City</b></p>
						<p> Contact number: <b id="contact_number">09173260074</b></p>
						<p> Email address: <b id="email_address">delabahan@gmail.com</b></p>
						<p> Date & Time: <b id="date_time">April 17,2019</b></p>
					</div>
				</div>
				<table class="table">
					<thead>
						<tr>
							<th class="text-left"><b>Food name</b></th>
							<th class="text-center"><b>QTY</b></th>
							<th class="text-center"><b>Price</b></th>
						</tr>
					</thead>
					<tbody id="tbody-order-list-view">
					</tbody>
					<tfoot id="fbody-order-list-view">
					</tfoot>
				</table>
			</div>
		</div>
	</div>
	<div class="modal-footer" style="background-color:#ffffff;">
		<div class="col-md-4 col-md-offset-4 text-center">
			<button type="button" class="mr-auto" id="myviewfood" >Proceed</button>
		</div>
	</div>
  </div>
</div>

<div class="modal fade" id="FOODqty" role="dialog">
	<div class="modal-content" id="foodqty">
	  <div class="modal-header">
		<input type="hidden" id="product-id">
		<input type="hidden" id="product-id-price">
		<span class="close" data-dismiss="modal">&times;</span>
		<h2 id="fname-menu-order">JAPANESE SIOMAI</h2>
	  </div>
	  <div class="modal-body" id="qtyFOOD">
			<div class="col-sm-12 col-md-12 col-lg-12  text-center">
				<img class="foodPIC  text-center" src="img/sample.jpg">
			</div>
			<div class="col-sm-12 col-md-12 col-lg-12  text-center">
				<textarea class="req" type="text" name="add-order-request" id="add-order-request" placeholder="PUT REQUEST HERE..." style="resize: vertical;"></textarea>
			</div>
			<div class="col-sm-12 col-md-12 col-lg-12 text-center">
				<div class="quantity buttons_added">
				   <button type="button" value="-" class="minus search-btn-light btn-danger">-</button>
				   <input type="number" step="1" min="1" max="" name="quantity" value="1" title="Qty" class="input-text qty text search-btn-light" size="4" pattern="" inputmode="">
				   <button type="button" value="+" class="plus search-btn-light btn-success">+</button>
				</div>
			</div>
			<div class="col-sm-12 col-md-12 col-lg-12">
				<div class="text-center">
				   <button class="ordbut" id="add-order-fname" data-dismiss="modal">ORDER</button>
				</div>
			</div>
	  </div>
	</div>
</div>

<div class="modal fade" id="EDITfood" role="dialog">
  <div class="modal-content" id="foodqty">
  <div class="modal-header">
	<input type="hidden" name="order-details-id" id="order-details-id">
	<input type="hidden" name="order-details-qty" id="order-details-qty">
	<input type="hidden" name="order-details-price" id="order-details-price">
	<span class="close" data-dismiss="modal">&times;</span>
	<h2 id="order-name">JAPANESE SIOMAI</h2>
  </div>
  <div class="modal-body" id="qtyFOOD">
	<div class="col-sm-12 col-md-12 col-lg-12  text-center">
		<img class="foodPIC  text-center" src="img/sample.jpg">
	</div>
	<div class="col-sm-12 col-md-12 col-lg-12  text-center">
		<textarea class="req" type="text" name="request" id="order-details-request" placeholder="PUT REQUEST HERE..." style="resize: vertical;"></textarea>
	</div>
	<div class="col-sm-12 col-md-12 col-lg-12 text-center">
		<div class="quantity buttons_added">
		   <button type="button" value="-" class="minus search-btn-light btn-danger">-</button>
		   <input type="number" step="1" min="1" max="" name="quantity" id="edit-quantity" value="1" title="Qty" class="input-text qty text search-btn-light" size="4" pattern="" inputmode="">
		   <button type="button" value="+" class="plus search-btn-light btn-success">+</button>
		</div>
	</div>
	<div class="col-sm-12 col-md-12 col-lg-12">
		<div class="text-center">
		   <button class="ordbut" id="edit-order-fname">ORDER</button>
		</div>
	</div>
  </div>
  </div>
</div>

<div class="modal fade" id="DELfood" role="dialog">
  <div class="modal-dialog modal-lg">
	<div class="modal-content">
	  <div class="modal-header">
		<span class="close" data-dismiss="modal">&times;</span>
		<input type="hidden" name="del-order" id="del-order">
		<h2>Delete Food</h2>
	  </div>
	  <div class="modal-body">
		<div class="regbox">
		  <p>Are you sure you want to remove this food?</p>
		  <button class="delete btn-danger" onclick="del_order(); return false;" name="del_btn">REMOVE</button>
		  <button class="no-delete"data-dismiss="modal">NO</button>
		</div>
	  </div>
	</div>
  </div>
</div>

<div id="map"></div>
</body>
<script src="lib/jquery.min.js"></script>
<script src="lib/bootstrap.min.js"></script>
<script src="js/jquery.growl.js" type="text/javascript"></script>
<script src="common/constants.js"></script>
<script src="common/app.js"></script>
<script>
$(function(){
	// $('#resto-name').text(localStorage.getItem("resto_name"));
	// $('input[name="latitude"]').val(localStorage.getItem("latitude"));
	// $('input[name="longitude"]').val(localStorage.getItem("longitude"));
	get_data();
});

// - Get menu data
function get_data() {
	CrapiApp.showCommonLoader();
	var resto_id  = localStorage.getItem("resto_id");
	CrapiApp.customerOrders({
		resto_id: resto_id
	})
	.then(function(result_data){
		$('#tbody-order-list').empty();
		$('#fbody-order-list').empty();
		$('#tbody-order-list-view').empty();
		$('#fbody-order-list-view').empty();
		if (result_data.result == 'OK') {
			var tbody_html = "";
			var fbody_html = "";
			var tbody_html_orders = "";
			var fbody_html_orders = "";
			var total_qty = 0;
			var sub_total = 0;
			var total_order = 0;
			$.each( result_data.data, function( key, value ) {
				console.log(value.SUB_TOTAL);
				if (value.id == undefined) {
					return false;
				}
				sub_total += parseInt(value.sub_total, 10);
				tbody_html +='<tr id="'+value.product_id+'">';
					tbody_html +='<td class="text-left">'+value.name+'</td>';
					tbody_html +='<td class="text-center">'+value.qty+'</td>';
					tbody_html +='<td class="text-center">P '+value.price+'</td>';
					tbody_html +='<td class="text-right">';
						tbody_html +='<button class="editbut" name="edit_btn" onclick="edit_order('+value.product_id+','+value.qty+','+value.price+',\'' + value.name + '\'); return false;"><i class="glyphicon glyphicon-edit"></i></button>';
						tbody_html +='<button class="deletebut" name="delete_btn" onclick="delete_order('+value.order_details_id+'); return false;"><i class="glyphicon glyphicon-trash"></i></button>';
					tbody_html +='</td>';
				tbody_html +='</tr>';
				tbody_html_orders +='<tr id="'+value.product_id+'">';
					tbody_html_orders +='<td class="text-left">'+value.name+'</td>';
					tbody_html_orders +='<td class="text-center">'+value.qty+'</td>';
					tbody_html_orders +='<td class="text-center">P '+value.price+'</td>';
				tbody_html_orders +='</tr>';

		}); 
			fbody_html +='<tr class="tfoot-bgcolor  font-text-amt">';
				fbody_html +='<th class="text-left font-text  font-text-amt">TOTAL</th>';
				fbody_html +='<th class="text-center"></th>';
				fbody_html +='<th class="text-center">P '+numberWithCommas(sub_total)+'</th>';
				fbody_html +='<th class="text-right font-text-amt"></th>';
			fbody_html +='</tr>';
			fbody_html_orders +='<tr class="tfoot-bgcolor  font-text-amt modal-footer-view-order">';
				fbody_html_orders +='<th class="text-left font-text  font-text-amt">TOTAL</th>';
				fbody_html_orders +='<th class="text-center"></th>';
				total_order = (sub_total*.12) + sub_total;
				fbody_html_orders +='<th class="text-center">P '+numberWithCommas(sub_total)+' <br>P '+numberWithCommas(parseInt(total_order, 10))+' (Incl. VAT) </th>';
			fbody_html +='</tr>';

			$('.order_hash').text(result_data.data[0].order_number);
			$('#customer_name').text(result_data.data[0].customer_fullname);
			$('#address').text(result_data.data[0].address);
			$('#contact_number').text(result_data.data[0].contact_number);
			$('#email_address').text(result_data.data[0].email);
			$('#date_time').text(result_data.data[0].created_at);

		$('#tbody-order-list').append(tbody_html);
		$('#fbody-order-list').append(fbody_html);
		$('#tbody-order-list-view').append(tbody_html_orders);
		$('#fbody-order-list-view').append(fbody_html_orders);
		}
	})
	.catch(function(err){
		console.warn(err);
		$.growl.error({ message: err.statusText});
	})
	.always(function(){
		CrapiApp.removeCommonLoader();
	});
}


// -Delete menu data
function delete_order(oid) {
	$('#DELfood').modal('show'); 
	$('#del-order').val(oid);
}

function del_order() {
	var oid = $('#del-order').val();
	CrapiApp.showCommonLoader();
	CrapiApp.orderDeleteUrl({
		order_id: $('#del-order').val()
	})
	.then(function(res){
		console.log(res);
		if (res.result === 'OK') {
			$.growl.notice({message: "Order was successfully deleted!" });
			get_data();
		} else {
			$.growl.error({message: "Order was not successfully deleted!" });
		}
	})
	.catch(function(res){
		console.log(res);
		// $.growl.notice({ message: res.error });
	})
	.always(function(){
		$('#'+oid).remove();
		CrapiApp.removeCommonLoader();
		$('#DELfood').modal('hide');
	});
}

$("#fsearch").click(function(){
	var fsearch = $('input[name="search"]').val(); 
	var login_token = localStorage.getItem("login_token");
	var role  = localStorage.getItem("role");    
	var resto_id  = localStorage.getItem("resto_id");
	$.ajax({
		type: "POST",
		url: "http://localhost/crapi_admin/api/orders/order_search", // Example 
		data: { "search":fsearch,"login_token":login_token,"role":role,"resto_id":resto_id},
		success: function(result_data){
			console.log(result_data);
			if (result_data.result == 'OK') {
				var tbody_html = "";
				var fbody_html = "";
				var total_qty = 0;
				var sub_total = 0;
				$('#tbody-order-list').empty();
				$('#fbody-order-list').empty();
				$.each( result_data.data, function( key, value ) {
						if (value.id == undefined) {
							return false;
						}
						sub_total += parseInt(value.sub_total, 10);
						tbody_html +='<tr id="'+value.id+'">';
							tbody_html +='<td class="text-left">'+value.name+'</td>';
							tbody_html +='<td class="text-center">'+value.qty+'</td>';
							tbody_html +='<td class="text-center">P'+value.price+'</td>';
							tbody_html +='<td class="text-right">';
								tbody_html +='<button class="editbut" name="edit_btn" onclick="edit_order('+value.product_id+','+value.qty+','+value.price+',\'' + value.name + '\'); return false;"><i class="glyphicon glyphicon-edit"></i></button>';
								tbody_html +='<button class="deletebut" name="delete_btn" onclick="delete_order('+value.id+'); return false;"><i class="glyphicon glyphicon-trash"></i></button>';
							tbody_html +='</td>';
						tbody_html +='</tr>';

				}); 
					fbody_html +='<tr class="tfoot-bgcolor  font-text-amt">';
						fbody_html +='<th class="text-left font-text  font-text-amt">TOTAL</th>';
						fbody_html +='<th class="text-center"></th>';
						fbody_html +='<th class="text-center">P '+numberWithCommas(sub_total)+'</th>';
						fbody_html +='<th class="text-right font-text-amt"></th>';
					fbody_html +='</tr>';
				$('#tbody-order-list').append(tbody_html);
				$('#fbody-order-list').append(fbody_html);
			}
		},
		error: function(e) {
			$.growl.error({ message: "Connection refused!"});
			return false;
		}
	});
});


// -Add menu data
function add_order() {
	$('#ADDfood').modal('show');
	$('input[name="quantity"]').val(0);
	var login_token = localStorage.getItem("login_token");
	var role  = localStorage.getItem("role");
	var resto_id  = localStorage.getItem("resto_id");   
	$.ajax({
		type: "POST",
		url: "http://localhost/crapi_admin/api/products/menu_list", // Example 
		data: {"login_token":login_token,"role":role,"resto_id":resto_id},
		success: function(result_data) {
			console.log(result_data);
			if (result_data.result == 'OK') {    
				var tbody_html = "";
				$.each( result_data.data, function( key, value ) {
						if (value.id == undefined) {
							return false;
						}
						tbody_html +='<tr '+value.id+'>';
						  tbody_html +='<th class="Fname"><a class="Fpick" onclick="menu_order('+value.product_id+',\'' + value.name + '\','+value.price+'); return false;"> '+value.name+'</a></th>';
						  tbody_html +='<th>P '+value.price+'</th>';
						tbody_html +='</tr>';
				}); 
				$('#food-name-list').empty().append(tbody_html);
			}
		},
		error: function(e) {
			$.growl.error({ message: "Connection refused!"});
			return false;
		}
	});
}

// -Add menu data
function menu_order(id,fname,price) {
	$('#FOODqty').modal('show');
	$('#fname-menu-order').text(fname);
	$('#product-id').val(id);
	$('#product-id-price').val(price);
	$('input[name="quantity"]').val(0);
}

$("#afsearch").click(function(){
	var fsearch = $('input[name="afsearch"]').val();
	var login_token = localStorage.getItem("login_token");
	var role  = localStorage.getItem("role");       
	$.ajax({
		type: "POST",
		url: "http://localhost/crapi_admin/api/products/product_search", // Example 
		data: { "search":fsearch,"login_token":login_token,"role":role},
		success: function(result_data){
			console.log(result_data);
			if (result_data.result == 'OK') {    
				var tbody_html = "";
				$.each( result_data.data, function( key, value ) {
						if (value.id == undefined) {
							return false;
						}
						tbody_html +='<tr '+value.id+'>';
						  tbody_html +='<th class="Fname"><a class="Fpick" onclick="menu_order('+value.product_id+',\'' + value.name + '\','+value.price+'); return false;"> '+value.name+'</a></th>';
						  tbody_html +='<th>P '+value.price+'</th>';
						tbody_html +='</tr>';
				}); 
				$('#food-name-list').empty().append(tbody_html);
			}
		},
		error: function(e) {
			$.growl.error({ message: "Connection refused!"});
			return false;
		}
	});
});

$("#add-order-fname").click(function(){
	var qty = $('input[name="quantity"]').val();
	var fname = $('#fname-menu-order').text();
	if (qty < 1) {
		$.growl.error({ title: qty+" "+fname,message: "Please select atleast 1 order" });
		return false;
	}
	$('#FOODqty').modal('hide');
	var formData = {
		"product_id": $('#product-id').val(),
		"qty": qty,
		"price": $('#product-id-price').val(),
		"description": $('#add-order-request').val(),
		"resto_id": localStorage.getItem("resto_id")
	};
	CrapiApp.showCommonLoader();
	CrapiApp.orderAddUrl(formData)
	.then(function(res){
		console.log(res);
		if (res.result === 'OK') {
			$.growl.notice({ title: qty+" "+fname,message: "Was successfully added!" });
		} else {
			$.growl.error({ title: qty+" "+fname,message: "Was not successfully added!" });
		}
	})
	.catch(function(res){
		console.log(res);
		// $.growl.notice({ message: res.error });
	})
	.always(function(){
		get_data();
		CrapiApp.removeCommonLoader();
		$('#FOODqty').modal('hide');
	});
});


// -Edit menu data
function edit_order(oid,qty,price,oname,desc) {
	$('#EDITfood').modal('show');
	$('#order-name').text(oname);
	$('#order-details-id').val(oid);
	$('#order-details-qty').val(qty);
	$('#edit-quantity').val(qty);
	$('#order-details-price').val(price);
	$('#order-details-request').text(desc);
}

$("#edit-order-fname").click(function(){
	var order_details_id = $('#order-details-id').val();
	var order_details_qty = $('#edit-quantity').val();
	var order_details_price = $('#order-details-price').val();
	var description  = $('#order-details-request').val();
	var fname = $('#order-name').text();
	var login_token = localStorage.getItem("login_token");
	var role  = localStorage.getItem("role");   
	var resto_id  = localStorage.getItem("resto_id");       
	if(order_details_qty < 1){
		 $.growl.error({ title: order_details_qty+" "+fname,message: "Please select atleast 1 order" });
		return false;
	}
	$('#EDITfood').modal('hide');
	$.ajax({
		type: "POST",
		url: "http://localhost/crapi_admin/api/orders/edit_orders", // Example 
		data: { "order_details_id":order_details_id,"login_token":login_token,"role":role,"qty":order_details_qty,"price":order_details_price,"description":description,"resto_id":resto_id},
		success: function(result_data){
			console.log(result_data);
			if (result_data.result == 'OK') {    
				get_data();
				$.growl.notice({ title: order_details_qty+" "+fname,message: "Was successfully updated!" });
			} else {
				$.growl.error({ title: order_details_qty+" "+fname,message: "Was not successfully updated!" });
			}
		},
		error: function(e) {
			$.growl.error({ message: "Connection refused!"});
			return false;
		}
	});
});

function view_order() {
	$('#VIEWloc').modal('show');
}

function wcqib_refresh_quantity_increments() {
	jQuery("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").each(function(a, b) {
		var c = jQuery(b);
		c.addClass("buttons_added"), c.children().first().before('<input type="button" value="-" class="minus" />'), c.children().last().after('<input type="button" value="+" class="plus" />')
	})
}
String.prototype.getDecimals || (String.prototype.getDecimals = function() {
	var a = this,
		b = ("" + a).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);
	return b ? Math.max(0, (b[1] ? b[1].length : 0) - (b[2] ? +b[2] : 0)) : 0
}), jQuery(document).ready(function() {
	wcqib_refresh_quantity_increments()
}), jQuery(document).on("updated_wc_div", function() {
	wcqib_refresh_quantity_increments()
}), jQuery(document).on("click", ".plus, .minus", function() {
	var a = jQuery(this).closest(".quantity").find(".qty"),
		b = parseFloat(a.val()),
		c = parseFloat(a.attr("max")),
		d = parseFloat(a.attr("min")),
		e = a.attr("step");
	b && "" !== b && "NaN" !== b || (b = 0), "" !== c && "NaN" !== c || (c = ""), "" !== d && "NaN" !== d || (d = 0), "any" !== e && "" !== e && void 0 !== e && "NaN" !== parseFloat(e) || (e = 1), jQuery(this).is(".plus") ? c && b >= c ? a.val(c) : a.val((b + parseFloat(e)).toFixed(e.getDecimals())) : d && b <= d ? a.val(d) : b > 0 && a.val((b - parseFloat(e)).toFixed(e.getDecimals())), a.trigger("change")
});
</script>
<script type="text/javascript">
	$('[type="submit"]').on('click', function(e){
		e.preventDefault();

		var response = confirm('Update information?');
		if (response) {
			$(this).closest('form').submit();
		};
	});

	// var map, marker, geocoder, searchBox;

	$('#updBtn').on('click', function(e){
		e.preventDefault();

		var response = confirm('Update information?');
		if (response) {
			$('form').submit();
		};
	});

	// function getDefaultMapCenter() {
	// 	var defaultLat = parseFloat($('[name=latitude]').val()) ||  10.3157,
	// 		defaultLng =  parseFloat($('[name=longitude]').val()) ||  123.8854;

	// 	return {
	// 		lat: defaultLat,
	// 		lng: defaultLng
	// 	}
	// }



	// function codeAddress() {
	// 	var address = $('[name=address]').val();
		
	// 	geocoder.geocode( { 'address': address}, function(results, status) {
	// 		if (status == 'OK') {
	// 			console.log(results);
	// 			map.setCenter(results[0].geometry.location);
	// 			marker.setPosition(results[0].geometry.location);
	// 		} else {
	// 			alert('Geocode was not successful for the following reason: ' + status);
	// 		}
	// 	});
	// }

	// function initMap() {

		// var NEW_ZEALAND_BOUNDS = {
		//  west: 124.6956015,
		//  east: 116.3667803,
		//  south: 4.657837,
		//  north: 19.366895
		// };


		// geocoder = new google.maps.Geocoder;

		// map = new google.maps.Map(document.getElementById('map'), {
		// 	zoom: 14,
		// 	center: getDefaultMapCenter(),
			// restriction: {
			//  latLngBounds: NEW_ZEALAND_BOUNDS,
			//  strictBounds: false,
			// },
		// });

		// marker = new google.maps.Marker({
		// 	map: map,
		// 	position: getDefaultMapCenter()
		// });

		// var markers = [];

		// map.addListener('click', function (e) {
		//  geocoder.geocode({'location': e.latLng}, function(results, status) {
		//      if (status === 'OK') {
		//          if (results[0]) {
		//              marker.setPosition(e.latLng);
		//              $('[name=address]').val(results[0].formatted_address)
		//              $('[name=latitude]').val(e.latLng.lat())
		//              $('[name=longitude]').val(e.latLng.lng())
		//          }
		//      }
		//  })
		// })
	// } 

	// $('[name=address]').keydown(function (e) {
	// 	if(e.keyCode === 13){
	// 		e.preventDefault();
	// 		codeAddress();
	// 	}
	// });
</script>
<script>
	// Note: This example requires that you consent to location sharing when
	// prompted by your browser. If you see the error "The Geolocation service
	// failed.", it means you probably did not give permission for the browser to
	// locate you.
	var map, infoWindow;
	function initMap() {
		map = new google.maps.Map(document.getElementById('map'), {
			center: {lat: -34.397, lng: 150.644},
			zoom: 6
		});
		infoWindow = new google.maps.InfoWindow;

		// Try HTML5 geolocation.
		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition(function(position) {
				var pos = {
					lat: position.coords.latitude,
					lng: position.coords.longitude
				};

				$('[name=latitude]').val(pos.lat);
				$('[name=longitude]').val(pos.lng);

				infoWindow.setPosition(pos);
				infoWindow.setContent('Location found.');
				infoWindow.open(map);
				map.setCenter(pos);
			}, function() {
				handleLocationError(true, infoWindow, map.getCenter());
			});
		} else {
		  // Browser doesn't support Geolocation
		  handleLocationError(false, infoWindow, map.getCenter());
		}
	}

	function handleLocationError(browserHasGeolocation, infoWindow, pos) {
		infoWindow.setPosition(pos);
		infoWindow.setContent(browserHasGeolocation ?
			'Error: The Geolocation service failed.' :
			'Error: Your browser doesn\'t support geolocation.');
		infoWindow.open(map);
	}
</script>
<script async="" defer="" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBb9gjcZGig7KAgoJC1EmMHA98Rp8Ayz98&amp;libraries=places&amp;callback=initMap"></script>
</html>